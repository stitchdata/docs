---
tap: "clubspeed"
version: "1.0"

name: "reservations"
singer-schema: "https://github.com/singer-io/tap-clubspeed/blob/master/tap_clubspeed/schemas/reservations.json"
description: |
  The `{{ table.name }}` table contains info about reservations. Reservations are indications that a [`customer`](#customers) is looking to purchase a spot in a [`booking`](#booking_availability) or has already purchased a spot.

  {% capture replication-note %}
  **Note**: This table uses `{{ replication-keys | strip }}` as the [Replication Key]({{ link.replication.rep-keys | prepend: site.baseurl }}). This means that reservations will be selected for replication only when they are initially created. Any subsequent updates made to the reservation will not be detected, as the `{{ replication-keys | strip }}` value will not be updated. Refer to the [Key-based Incremental Replication documentation]({{ link.replication.key-based-incremental | prepend: site.baseurl }}) for more info and examples.
  {% endcapture %}

  {% include note.html type="single-line" content=replication-note %}

replication-method: "Key-based Incremental"

attributes:
  - name: "onlineBookingReservationsId"
    type: "integer"
    primary-key: true
    description: "The online booking reservation ID."
    foreign-key-id: "reservation-id"

  - name: "createdAt"
    type: "date-time"
    replication-key: true
    description: "The timestamp at which the reservation was created."

  - name: "checkId"
    type: "integer"
    description: "The ID of the check for the reservation."
    foreign-key-id: "check-id"

  - name: "customersId"
    type: "integer"
    description: "The ID of the customer for the reservation."
    foreign-key-id: "customer-id"

  - name: "expiresAt"
    type: "date-time"
    description: "The timestamp at which the reservation will be automatically expired, if the status (`onlineBookingReservationStatusId`) is not set to `1` (Permanent)."

  - name: "onlineBookingReservationStatusId"
    type: "integer"
    description: |
      The ID for the status of the reservation. Statuses should be set to Temporary while the underlying kart is open, and set to Permanent after the purchase has been made. Possible values are:

      - `1` - Temporary
      - `2` - Permanent

  - name: "onlineBookingsId"
    type: "integer"
    description: "The ID of the booking for the reservation."
    foreign-key-id: "booking-id"

  - name: "quantity"
    type: "integer"
    description: "The quantity of reservations to hold."

  - name: "sessionId"
    type: "string"
    description: "An optional session identifier to be used for documentation and debugging purposes, typically generated by an external website."
---