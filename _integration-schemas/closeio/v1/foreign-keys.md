---
tap-reference: "closeio"

version: "1.0"

foreign-keys:
  - id: "activity-id"
    attribute: "activity_id"
    table: "activities"
    all-foreign-keys:
      - table: "activities"
        join-on: "id"

  - id: "contact-id"
    attribute: "contact_id"
    table: ""
    all-foreign-keys:
      - table: "activities"
      - table: "leads"
        subtable: "contacts"
        join-on: "id"
      - table: "leads"
        subtable: "opportunities"
      - table: "leads"
        subtable: "tasks"
      - table: "tasks"

  - id: "event-id"
    attribute: "event_id"
    table: "event_log"
    all-foreign-keys:
      - table: "event_log"
        join-on: "id"

  - id: "lead-id"
    attribute: "lead_id"
    table: "leads"
    all-foreign-keys:
      - table: "activities"
      - table: "event_log"
      - table: "leads"
        join-on: "id"
      - table: "leads"
        subtable: "contacts"
      - table: "leads"
        subtable: "opportunities"
      - table: "leads"
        subtable: "tasks"
      - table: "tasks"

  - id: "organization-id"
    attribute: "organization_id"
    table: ""
    all-foreign-keys:
      - table: "activities"
      - table: "custom_fields"
      - table: "event_log"
      - table: "leads"
        subtable: "contacts"
      - table: "leads"
        subtable: "opportunities"
      - table: "leads"
      - table: "leads"
        subtable: "tasks"
      - table: "tasks"
      - table: "users"
        subtable: "organizations"
        join-on: "id"

  - id: "task-id"
    attribute: "task_id"
    table: "tasks"
    all-foreign-keys:
      - table: "activities"
      - table: "leads"
        subtable: "tasks"
        join-on: "id"
      - table: "tasks"
        join-on: "id"

  - id: "user-id"
    attribute: "user_id"
    table: "users"
    all-foreign-keys:
      - table: "activities"
        join-on: "created_by"
      - table: "activities"
        join-on: "updated_by"
      - table: "activities"
      - table: "activities"
        join-on: "task_assigned_to"
      - table: "activities"
        subtable: "users"
        join-on: "id"

      - table: "custom_fields"
        join-on: "created_by"
      - table: "custom_fields"
        join-on: "updated_by"

      - table: "event_log"

      - table: "leads"
        subtable: "contacts"
        join-on: "created_by"
      - table: "leads"
        subtable: "contacts"
        join-on: "updated_by"
      - table: "leads"
        join-on: "created_by"
      - table: "leads"
        subtable: "opportunities"
        join-on: "created_by"
      - table: "leads"
        subtable: "opportunities"
        join-on: "updated_by"
      - table: "leads"
        subtable: "opportunities"
      - table: "leads"
        subtable: "tasks"
        join-on: "assigned_to"
      - table: "leads"
        subtable: "tasks"
        join-on: "created_by"
      - table: "leads"
        subtable: "tasks"
        join-on: "updated_by"
      - table: "leads"
        join-on: "updated_by"

      - table: "tasks"
        join-on: "assigned_to"
      - table: "tasks"
        join-on: "created_by"
      - table: "tasks"
        join-on: "updated_by"

      - table: "users"
        join-on: "id"
---